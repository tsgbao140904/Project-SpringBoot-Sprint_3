<!DOCTYPE html>
<html lang="vi" xmlns:th="http://www.thymeleaf.org">

<head>
  <meta charset="UTF-8">
  <title>Chi tiáº¿t cÃ´ng thá»©c</title>

  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

  <style>
    body { background: #f5f5f7; font-family: system-ui, sans-serif; }

    .detail-card {
        border-radius: 18px;
        background: white;
        box-shadow: 0 10px 25px rgba(0,0,0,0.15);
        overflow: hidden;
    }

    .detail-img {
        height: 320px;
        width: 100%;
        object-fit: cover;
    }

    .category-pill {
        position: absolute;
        top: 15px;
        right: 15px;
        padding: 6px 14px;
        border-radius: 999px;
        color: white;
        font-size: 13px;
        font-weight: 600;
    }
  </style>
</head>

<body class="p-3">

<!-- ğŸ”™ NÃšT QUAY Láº I -->
<a th:if="${isCommunity != null and isCommunity}"
   href="/app/community"
   class="btn btn-secondary mb-3">â† Quay láº¡i cá»™ng Ä‘á»“ng</a>

<a th:if="${isCommunity == null or !isCommunity}"
   href="/app/home"
   class="btn btn-secondary mb-3">â† Quay láº¡i</a>



<div class="container">
  <div class="detail-card">

    <div class="position-relative">
      <img th:src="${recipe.imageUrl}" class="detail-img">

      <span class="category-pill"
            th:style="'background:' + ${recipe.userCategory.colorCode}">
                <span th:text="${recipe.userCategory.icon}"></span>
                <span th:text="${recipe.userCategory.name}"></span>
            </span>
    </div>

    <div class="p-4">

      <h2 class="fw-bold mb-2" th:text="${recipe.title}"></h2>
      <div th:if="${recipe.shareStatus != null}" class="mt-2">

        <div th:if="${recipe.shareStatus == 'PENDING'}"
             class="alert alert-warning">
          â³ CÃ´ng thá»©c nÃ y Ä‘ang chá» admin duyá»‡t.
        </div>

        <div th:if="${recipe.shareStatus == 'APPROVED'}"
             class="alert alert-success">
          âœ” CÃ´ng thá»©c Ä‘Ã£ Ä‘Æ°á»£c admin duyá»‡t!
        </div>

        <div th:if="${recipe.shareStatus == 'REJECTED'}"
             class="alert alert-danger">
          âŒ CÃ´ng thá»©c bá»‹ tá»« chá»‘i.
          <br>
          <small th:text="'LÃ½ do: ' + ${recipe.shareRejectedReason}"></small>
        </div>

      </div>

      <div class="mb-2">
        <strong>Calories:</strong>
        <span th:text="${recipe.calories}"></span> calo
      </div>

      <div class="mb-3">
        <strong>Thá»i gian:</strong>
        <span th:text="${recipe.cookingTime}"></span> phÃºt
      </div>

      <hr>

      <h5>NguyÃªn liá»‡u</h5>
      <p th:text="${recipe.ingredients}"></p>

      <h5>HÆ°á»›ng dáº«n</h5>
      <p th:text="${recipe.instructions}"></p>

      <hr>

      <!-- ğŸ”¥ CHá»ˆ CHá»¦ CÃ”NG THá»¨C THáº¤Y NÃšT -->
      <!-- ğŸ”¥ NÃšT CHá»ˆ CHO PHÃ‰P SHARE 1 Láº¦N -->
      <div th:if="${isOwner != null and isOwner}" class="mt-3">

        <a th:href="@{'/app/recipes/' + ${recipe.id} + '/edit'}"
           class="btn btn-warning"
           th:if="${recipe.shareStatus != 'APPROVED'}">
          âœ Sá»­a
        </a>

        <button class="btn btn-secondary"
                th:if="${recipe.shareStatus == 'APPROVED'}"
                disabled>
          âœ ÄÃ£ duyá»‡t â€“ KhÃ´ng thá»ƒ sá»­a
        </button>

        <form th:action="@{'/app/recipes/' + ${recipe.id} + '/delete'}"
              method="post" style="display:inline">
          <button class="btn btn-danger">ğŸ—‘ XÃ³a</button>
        </form>

        <!-- â­ ChÆ°a share hoáº·c Ä‘Ã£ bá»‹ tá»« chá»‘i -> Cho phÃ©p share -->
        <form th:if="${recipe.shareStatus == null or recipe.shareStatus == 'REJECTED'}"
              th:action="@{'/app/recipes/' + ${recipe.id} + '/share'}"
              method="post"
              style="display:inline">
          <button class="btn btn-info"
                  onclick="return confirm('Báº¡n cháº¯c cháº¯n muá»‘n chia sáº» cÃ´ng thá»©c nÃ y chá»©?')">
            ğŸ”— Chia sáº»
          </button>
        </form>

        <!-- â³ Äang chá» duyá»‡t -->
        <button th:if="${recipe.shareStatus == 'PENDING'}"
                class="btn btn-secondary"
                disabled>
          â³ Chá» duyá»‡t
        </button>

        <!-- âœ” ÄÃ£ duyá»‡t -->
        <button th:if="${recipe.shareStatus == 'APPROVED'}"
                class="btn btn-success"
                disabled>
          âœ” ÄÃ£ duyá»‡t
        </button>

      </div>

    </div>
  </div>
</div>

</body>
</html>
