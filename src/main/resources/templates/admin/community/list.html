<!DOCTYPE html>
<html lang="vi" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Duy·ªát c√¥ng th·ª©c</title>

    <link rel="stylesheet"
          href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css">

    <style>
        body { background: #f5f7fb; font-family: system-ui, sans-serif; }

        .sidebar {
            background: linear-gradient(180deg, #111827, #1f2937);
            color: white;
            min-height: 100vh;
            padding: 20px;
        }
        .nav-link {
            border-radius: 999px;
            padding: 8px 14px;
            color: white;
        }
        .nav-link.active {
            background: #22c55e;
            font-weight: 700;
        }

        .section-title {
            font-size: 22px;
            font-weight: 700;
        }

        .card-approve { border-radius: 18px; }
    </style>
</head>

<body>

<div class="container-fluid">

    <div class="row">

        <!-- SIDEBAR -->
        <div class="col-md-3 col-lg-2 sidebar">

            <h4 class="mb-3">Admin Panel</h4>

            <a href="/admin/dashboard"
               class="nav-link mb-2">üìä Dashboard</a>

            <a href="/admin/users"
               class="nav-link mb-2">üë§ Qu·∫£n l√Ω ng∆∞·ªùi d√πng</a>

            <a href="/admin/community"
               class="nav-link active">üåé Duy·ªát c√¥ng th·ª©c</a>

            <form class="mt-4" th:action="@{/logout}" method="post">
                <button class="btn btn-outline-light w-100">ƒêƒÉng xu·∫•t</button>
            </form>

        </div>


        <!-- MAIN -->
        <div class="col-md-9 col-lg-10 p-4">

            <h3 class="section-title mb-3">Duy·ªát c√¥ng th·ª©c c·ªông ƒë·ªìng</h3>

            <!-- TAB -->
            <ul class="nav nav-tabs mb-3">
                <li class="nav-item">
                    <a class="nav-link"
                       th:classappend="${tab=='pending'} ? 'active' : ''"
                       th:href="@{/admin/community(tab='pending')}">‚è≥ Ch·ªù duy·ªát</a>
                </li>

                <li class="nav-item">
                    <a class="nav-link"
                       th:classappend="${tab=='approved'} ? 'active' : ''"
                       th:href="@{/admin/community(tab='approved')}">‚úî ƒê√£ duy·ªát</a>
                </li>

                <li class="nav-item">
                    <a class="nav-link"
                       th:classappend="${tab=='rejected'} ? 'active' : ''"
                       th:href="@{/admin/community(tab='rejected')}">‚ùå T·ª´ ch·ªëi</a>
                </li>
            </ul>


            <!-- LIST -->
            <div class="row g-3">

                <div class="col-md-4" th:each="r : ${recipes}">
                    <div class="card card-approve shadow-sm">

                        <img th:src="${r.imageUrl}"
                             class="card-img-top"
                             style="height:180px; width:100%; object-fit:cover;">


                        <div class="card-body">

                            <h5 th:text="${r.title}"></h5>

                            <p class="small text-muted"
                               th:text="${r.ingredients}">
                                ...
                            </p>

                            <div class="d-flex justify-content-between">

                                <!-- APPROVE BUTTON -->
                                <form th:if="${tab == 'pending'}"
                                      th:action="@{'/admin/community/' + ${r.id} + '/approve'}"
                                      method="post">
                                    <button class="btn btn-success btn-sm">Duy·ªát</button>
                                </form>

                                <!-- REJECT BUTTON -->
                                <button th:if="${tab == 'pending'}"
                                        class="btn btn-danger btn-sm"
                                        data-bs-toggle="modal"
                                        th:data-bs-target="'#rejectModal' + ${r.id}">
                                    T·ª´ ch·ªëi
                                </button>

                            </div>

                        </div>

                    </div>

                    <!-- MODAL REJECT -->
                    <div class="modal fade"
                         th:id="'rejectModal' + ${r.id}"
                         tabindex="-1">
                        <div class="modal-dialog">
                            <div class="modal-content">

                                <form th:action="@{'/admin/community/' + ${r.id} + '/reject'}"
                                      method="post">

                                    <div class="modal-header">
                                        <h5 class="modal-title">L√Ω do t·ª´ ch·ªëi</h5>
                                        <button type="button"
                                                class="btn-close"
                                                data-bs-dismiss="modal">
                                        </button>
                                    </div>

                                    <div class="modal-body">
                                        <textarea class="form-control"
                                                  name="reason"
                                                  rows="4"
                                                  placeholder="Nh·∫≠p l√Ω do t·ª´ ch·ªëi..."
                                                  required></textarea>
                                    </div>

                                    <div class="modal-footer">
                                        <button class="btn btn-secondary"
                                                data-bs-dismiss="modal">H·ªßy</button>
                                        <button class="btn btn-danger"
                                                type="submit">T·ª´ ch·ªëi</button>
                                    </div>

                                </form>

                            </div>
                        </div>
                    </div>

                </div>

            </div>

            <p th:if="${#lists.isEmpty(recipes)}"
               class="text-muted mt-3">
                Kh√¥ng c√≥ c√¥ng th·ª©c n√†o.
            </p>

        </div>

    </div>

</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

</body>
</html>
